#!/bin/sh
# portable subst (for systems without sed -i)
# TODO: use sed -i if possible
set +e
SCRIPT=$1; shift

# Check for broken mktemp
if mktemp -V 2>/dev/null >/dev/null ; then
	T=`mktemp || exit 1`
else
	T=`mktemp /tmp/$NAME.XXXXXX || exit 1`
fi

for s in "$@"; do
	if cat $s | sed "$SCRIPT" > $T; then
	   cat $T > $s
	else
		exit 1
	fi
done

rm -f $T
exit 0
